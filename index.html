<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="Picognito - Anonymously Share Your World" />
		<title>Picognito</title>
		<link rel="stylesheet" href="css/main.css" />
		<link rel="stylesheet" href="css/map.css" />
		<!-- PWA manifest -->
		<link rel="manifest" href="manifest.json" />
		<!-- Favicon -->
		<link rel="icon" href="images/favicon.ico" type="image/x-icon" />
	</head>
	<body>
		<header>
			<h1>Picognito</h1>
			<theme-toggle></theme-toggle>
		</header>

		<main>
			<section class="map-section" id="map-section" aria-labelledby="map-heading">
				<h2 id="map-heading" class="sr-only">Interactive Map</h2>

				<div class="map-loading" id="map-loading" aria-live="polite">
					<p>Loading map...</p>
				</div>

				<div class="map-wrapper">
					<map-container
						latitude="40.7128"
						longitude="-74.0060"
						zoom="12"
						aria-busy="true"
						aria-labelledby="map-heading"
					>
					</map-container>
				</div>
			</section>
		</main>

		<footer>
			<p>
				&copy; 2024 Picognito - <a href="about.html">About</a> -
				<a href="contact.html">Contact</a>
			</p>
		</footer>

		<!-- Web Components -->
		<script type="module" src="js/components/theme-toggle.js"></script>
		<script type="module" src="js/components/map-container.js"></script>

		<!-- Main script to initialize components -->
		<script type="module">
			document.addEventListener('DOMContentLoaded', () => {
				// Handle map ready event
				document.querySelector('map-container').addEventListener('map-ready', (event) => {
					console.log('üó∫Ô∏è üéâ Map is ready to use!', event.detail);
					document.getElementById('map-loading').classList.add('hidden');
				});

				// Handle map error event
				document.querySelector('map-container').addEventListener('map-error', (event) => {
					console.error('üó∫Ô∏è ‚ö†Ô∏è Map failed to initialize', event.detail);
					const loadingEl = document.getElementById('map-loading');
					loadingEl.innerHTML = `<p>Failed to load map. Please try refreshing the page.</p>`;
					loadingEl.classList.add('error');
				});
			});
		</script>
	</body>
</html>
